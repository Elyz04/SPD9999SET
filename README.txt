000000*****************************************************************
000000* 業務仕様説明（SRC完全準拠・最新版）
000000*---------------------------------------------------------------*
000000* UPDATE :
000000*   2026/01/19 : ソースコード反映による全面改訂
000000*---------------------------------------------------------------*
000000* プログラムID : PGM001
000000*---------------------------------------------------------------*
000000* プログラム概要
000000*---------------------------------------------------------------*
000000* 本プログラムは、銀行ABCの預金管理システムにおいて、
000000* JCL パラメータで指定された処理種別に基づき、
000000*
000000*   ・利息計算処理（FUNCTION-001）
000000*   ・満期／前倒し決済処理（FUNCTION-002）
000000*
000000* を実行する COBOL + DB2 バッチプログラムである。
000000*
000000* 対象となる預金契約は、
000000* DB_ACCOUNT_SAVINGS テーブルに存在し、
000000* STATUS = '1'（有効）のレコードのみとする。
000000*
000000* FUNCTION-001 は表示専用処理であり、
000000* DB 更新および COMMIT は一切行わない。
000000*
000000* FUNCTION-002 においてのみ、
000000* 決済処理および DB 更新を行い、
000000* 正常終了時に COMMIT を実施する。
000000*---------------------------------------------------------------*
000000* 実行制御（JCL パラメータ）
000000*---------------------------------------------------------------*
000000* PARM 形式：
000000*   (FUNC,ACC_ID,DATE)
000000*
000000* FUNC：
000000*   '1' : FUNCTION-001 のみ実行
000000*   '2' : FUNCTION-002 のみ実行
000000*   '3' : FUNCTION-001 実行後、FUNCTION-002 を続行
000000*
000000* ACC_ID：
000000*   - 必須パラメータ
000000*   - 数値項目
000000*
000000* DATE：
000000*   - 任意パラメータ
000000*   - 未指定（SPACES）の場合、
000000*     FUNCTION CURRENT-DATE(1:8) を使用
000000*---------------------------------------------------------------*
000000* 対象テーブル
000000*---------------------------------------------------------------*
000000* 【DB_ACCOUNT_SAVINGS】
000000*   - ORDER_ID
000000*   - ACC_ID
000000*   - SAVING_TYPE
000000*   - START_DATE
000000*   - END_DATE
000000*   - MONEY_ROOT
000000*   - STATUS
000000*
000000* 【DB_INTEREST_INFO】
000000*   - SAVING_TYPE
000000*   - INTEREST_RATE
000000*
000000* 【DB_ACCOUNT_BALANCE】
000000*   - ACC_ID
000000*   - BALANCE
000000*---------------------------------------------------------------*
000000* 共通処理仕様（SRC準拠）
000000*---------------------------------------------------------------*
000000* ・ACC_ID の存在チェックを行う
000000*     - 存在しない場合：
000000*         'ACC_ID NOT FOUND' を出力し STOP RUN
000000*
000000* ・ACC_ID に紐づく有効契約が存在しない場合：
000000*     'ACC_ID HAS BEEN FULLY SETTLED' を出力し STOP RUN
000000*
000000* ・カーソル処理により 1 件ずつデータを取得する
000000*
000000* ・SQLCODE 判定
000000*     SQLCODE = 0   ：正常
000000*     SQLCODE = 100 ：FETCH 終了（正常）
000000*     SQLCODE < 0   ：異常（ABEND）
000000*
000000* ・SQLCODE < 0 の場合：
000000*     CST-ABEND-BREAKPOINT に処理名を設定し、
000000*     ABEND-PROGRAM を実行する
000000*
000000* ・ROLLBACK 処理は ABEND-PROGRAM 内で実施する
000000*---------------------------------------------------------------*
000000* FUNCTION-001：利息計算処理（表示専用）
000000*---------------------------------------------------------------*
000000* 【処理概要】
000000* 指定された ACC_ID に紐づく有効な預金契約に対し、
000000* 利息計算を行い、結果を表示する。
000000*
000000* 本処理では DB 更新は行わない。
000000*
000000* 【処理詳細】
000000* 1. 対象データ取得
000000*   - ACC_ID
000000*   - STATUS = '1'
000000*
000000* 2. 日付処理
000000*   - 処理日付 < START_DATE の場合、
000000*     経過日数 = 0
000000*
000000* 3. 利率取得
000000*   - DB_INTEREST_INFO より SAVING_TYPE に対応する利率を取得
000000*
000000* 4. 利息計算
000000*   INTEREST = MONEY_ROOT × RATE × DAYS ÷ 365
000000*
000000* 5. 計算結果を表示
000000*
000000* ※ COMMIT / ROLLBACK は実施しない
000000*---------------------------------------------------------------*
000000* FUNCTION-002：満期／前倒し決済処理
000000*---------------------------------------------------------------*
000000* 【処理概要】
000000* 指定された ACC_ID に紐づく有効な預金契約を対象に、
000000* 満期または前倒し解約を判定し、
000000* 決済処理および DB 更新を行う。
000000*
000000* 【処理詳細】
000000* 1. 対象データ取得
000000*   - ACC_ID
000000*   - STATUS = '1'
000000*
000000* 2. 利息計算
000000*
000000* 【非定期預金】
000000*   INTEREST = MONEY_ROOT × 非定期利率 × 経過日数 ÷ 365
000000*
000000* 【定期預金】
000000*   - 満期到達：
000000*       契約日数を使用して利息計算
000000*   - 前倒し解約：
000000*       非定期利率を使用して利息計算
000000*
000000* 3. 決済金額算出
000000*   MONEY = MONEY_ROOT + INTEREST
000000*
000000* 4. DB 更新
000000*   - DB_ACCOUNT_BALANCE.BALANCE に MONEY を加算
000000*   - DB_ACCOUNT_SAVINGS.STATUS を '9' に更新
000000*
000000* 5. 正常終了時 COMMIT 実行
000000*---------------------------------------------------------------*
000000* エラー処理
000000*---------------------------------------------------------------*
000000* ・SQLCODE < 0 の場合
000000*     - ABEND-PROGRAM 実行
000000*     - ROLLBACK
000000*     - STOP RUN
000000*
000000* ・SQLCODE = 100 の場合
000000*     - カーソル終了
000000*     - 正常終了
000000*---------------------------------------------------------------*
000000* 注意事項
000000*---------------------------------------------------------------*
000000* ・COMMIT は FUNCTION-002 正常終了時のみ実行する
000000* ・FUNCTION-001 では DB を更新しない
000000* ・本仕様書はソースコード（SRC）を正とする
000000*****************************************************************
