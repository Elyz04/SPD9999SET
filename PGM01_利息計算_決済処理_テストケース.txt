000000*****************************************************************
000000* テストケース仕様書（PGM001 利息計算・決済処理用）【SRC反映版】
000000*---------------------------------------------------------------*
000000* UPDATE :
000000*   2026/01/19 : 初版作成（SRC完全反映）
000000*---------------------------------------------------------------*
000000* プログラムID : PGM001
000000*---------------------------------------------------------------*
000000* プログラム概要
000000*---------------------------------------------------------------*
000000* 本テストケースは、銀行ABCの預金管理システムにおける
000000* PGM001 プログラムの処理内容が、SRC（COBOL / DB2）
000000* と一致していることを検証するためのものである。
000000*
000000* 対象処理：
000000*   ・FUNCTION-001：利息計算処理（表示専用）
000000*   ・FUNCTION-002：満期決済処理（DB更新あり）
000000*
000000* 実行機能は JCL の PARM により制御される。
000000*---------------------------------------------------------------*
000000* テスト目的
000000*---------------------------------------------------------------*
000000* 1. 利息計算ロジックが SRC 定義通りに動作すること
000000* 2. 満期判定および決済処理が正しく行われること
000000* 3. SQLCODE 判定・ABEND 処理が SRC 通りであること
000000* 4. カーソル処理（OPEN / FETCH / CLOSE）が正しく制御されること
000000*---------------------------------------------------------------*
000000* 前提条件（SRC反映）
000000*---------------------------------------------------------------*
000000* ・対象テーブル
000000*   - DB_ACCOUNT_SAVINGS
000000*   - DB_ACCOUNT_BALANCE
000000*   - DB_INTEREST_INFO
000000*
000000* ・対象レコード条件
000000*   - STATUS = '1'
000000*
000000* ・カーソル処理により 1件ずつ処理する
000000*
000000* ・SQLCODE 判定
000000*   - SQLCODE = 0   ：正常
000000*   - SQLCODE = 100 ：FETCH 終了（正常終了）
000000*   - SQLCODE < 0   ：異常（ABEND）
000000*---------------------------------------------------------------*
000000* パラメータ仕様（JCL）
000000*---------------------------------------------------------------*
000000* PARM = '1'
000000*   → FUNCTION-001（利息計算・表示のみ）
000000*
000000* PARM = '2'
000000*   → FUNCTION-002（満期決済処理・DB更新あり）
000000*
000000* PARM = '3'
000000*   → FUNCTION-001 実行後、FUNCTION-002 を続行
000000*
000000* 上記以外
000000*   → INVALID PARAM メッセージ出力後 STOP RUN
000000*---------------------------------------------------------------*
000000* 共通仕様（SRC準拠）
000000*---------------------------------------------------------------*
000000* ・処理日付が SPACES の場合
000000*     → FUNCTION CURRENT-DATE(1:8) を使用
000000*
000000* ・処理日付が過去日の場合
000000*     → INVALID DATE PARAM 出力後 STOP RUN
000000*
000000* ・利息計算は SRC 定義ロジックを使用
000000*
000000* ・FUNCTION-001 は DB 更新・COMMIT を行わない
000000*
000000* ・FUNCTION-002 正常終了時のみ COMMIT を実施
000000*
000000* ・SQLCODE < 0 の場合
000000*     → CST-ABEND-BREAKPOINT 設定
000000*     → ABEND-PROGRAM 呼出
000000*
000000* ・ROLLBACK は ABEND-PROGRAM 内で実施する
000000*---------------------------------------------------------------*
000000* 1. 正常系テストケース
000000*---------------------------------------------------------------*
000000* ケース1：FUNCTION-001 利息計算（表示専用）
000000*---------------------------------------------------------------*
000000* 条件
000000*   - PARM = '1'
000000*   - STATUS = '1'
000000*
000000* 処理内容
000000*   - カーソル OPEN
000000*   - FETCH 処理
000000*   - 利息計算（SRC ロジック）
000000*   - 計算結果を表示
000000*
000000* 期待結果
000000*   - 計算結果が SRC と一致する
000000*   - DB 更新なし
000000*   - COMMIT / ROLLBACK は行われない
000000*---------------------------------------------------------------*
000000* ケース2：FUNCTION-002 満期決済処理
000000*---------------------------------------------------------------*
000000* 条件
000000*   - PARM = '2'
000000*   - STATUS = '1'
000000*
000000* 処理内容
000000*   - カーソル OPEN / FETCH
000000*   - 満期判定
000000*   - 利息計算（SRC ロジック）
000000*   - DB 更新
000000*     ・DB_ACCOUNT_BALANCE 更新
000000*     ・DB_ACCOUNT_SAVINGS.STATUS = '9'
000000*   - 正常終了時 COMMIT
000000*
000000* 期待結果
000000*   - 残高が正しく更新される
000000*   - ステータスが決済済になる
000000*---------------------------------------------------------------*
000000* ケース3：PARM = '3'
000000*---------------------------------------------------------------*
000000* 条件
000000*   - PARM = '3'
000000*
000000* 処理内容
000000*   - FUNCTION-001 実行（表示）
000000*   - 続けて FUNCTION-002 実行
000000*
000000* 期待結果
000000*   - 表示後、決済処理まで正常に完了する
000000*---------------------------------------------------------------*
000000* 2. 異常系テストケース
000000*---------------------------------------------------------------*
000000* ケースA：SQL エラー
000000*---------------------------------------------------------------*
000000* 条件
000000*   - SQLCODE < 0 発生
000000*
000000* 期待結果
000000*   - CST-ABEND-BREAKPOINT 設定
000000*   - ABEND-PROGRAM 実行
000000*   - ROLLBACK 実施
000000*   - STOP RUN
000000*---------------------------------------------------------------*
000000* ケースB：FETCH 終了
000000*---------------------------------------------------------------*
000000* 条件
000000*   - FETCH 時 SQLCODE = 100
000000*
000000* 期待結果
000000*   - 正常終了
000000*   - COMMIT 実行なし
000000*---------------------------------------------------------------*
000000* ケースC：日付不正
000000*---------------------------------------------------------------*
000000* 条件
000000*   - 処理日付 < CURRENT-DATE
000000*
000000* 期待結果
000000*   - INVALID DATE PARAM 出力
000000*   - STOP RUN
000000*---------------------------------------------------------------*
000000* ケースD：無効パラメータ
000000*---------------------------------------------------------------*
000000* 条件
000000*   - PARM ≠ '1','2','3'
000000*
000000* 期待結果
000000*   - INVALID PARAM 出力
000000*   - STOP RUN
000000*---------------------------------------------------------------*
000000* 備考
000000*---------------------------------------------------------------*
000000* ・本仕様書は SRC（COBOL）を正とする
000000* ・テスト結果は SQLCODE およびログで確認する
000000*****************************************************************
